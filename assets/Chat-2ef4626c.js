import{u as y,a as l,c as d,k as M,b as s,t as p,d as j,n as D,e as b,F as f,q as g,r as v,s as B,o as C,x as T,g as $,w as q,j as E,v as V,y as Y,z as m,A as h,B as L,C as N,D as U,T as z,E as F}from"./index-b3cf4afc.js";const H={class:"bg-success text-white rounded-2 px-2 py-1"},G={class:""},I={__name:"ChatList",props:{reversedDocuments:{type:Array,required:!0}},setup(i){const u=y(),n=t=>{if(!t)return"";const _=t.toDate();return g(_).format("DD/MM/YYYY HH:mm:ss")};return(t,_)=>(l(!0),d(f,null,M(i.reversedDocuments,e=>{var o;return l(),d("li",{key:`${e==null?void 0:e.createdAt.seconds}${e==null?void 0:e.createdAt.nanoseconds}`},[s("div",{class:D(["mt-2 me-2 py-1 chat__user",e.sender===((o=b(u).userData)==null?void 0:o.nombre)?"text-end":"text-start"])},[s("span",H,p(e==null?void 0:e.sender),1),j(" "+p(n(e==null?void 0:e.createdAt))+" ",1),s("div",G,p(e==null?void 0:e.msg),1)],2)])}),128))}};const J=s("h2",null,"Chat Global",-1),K={class:"chat__window"},O={key:0},P={key:1},Q=["onSubmit"],R={class:"mt-3 col-sm-12"},W={class:"me-2 mt-3 col-sm-12"},Z={__name:"Chat",props:{isDark:{type:Boolean}},setup(i){let u=v([]),n=v(!1),t=null;const _=B(()=>[...u.value].reverse()),e=y(),o=v(""),x=()=>{n.value=!0;try{const r=Y(m(h,"chats"),L("createdAt","desc"),N(12));return t=U(r,c=>{u.value=c.docs.map(a=>({id:a.id,...a.data()})),n.value=!1}),t}catch(r){console.log(r),n.value=!1}},k=async(r,c)=>{try{const a=g().toDate(),S=z.fromDate(a),A={msg:r,sender:c,createdAt:S};await F(m(h,"chats"),A)}catch(a){console.error("Error enviando mensaje: ",a)}};C(()=>{x()}),T(()=>{t&&t()});const w=()=>{k(o.value,e.userData.nombre),o.value=""};return(r,c)=>(l(),d(f,null,[J,s("div",null,[s("div",K,[b(n)?(l(),d("div",O,"Loading docs...")):(l(),d("ul",P,[$(I,{reversedDocuments:_.value},null,8,["reversedDocuments"])]))]),s("form",{onSubmit:q(w,["prevent"]),class:"input-group input-group-sm mb-3 row"},[s("div",R,[E(s("input",{type:"text",class:"form-control",placeholder:"Ingrese Mensaje","onUpdate:modelValue":c[0]||(c[0]=a=>o.value=a)},null,512),[[V,o.value]])]),s("div",W,[s("button",{type:"submit",class:D(["btn col me-2",i.isDark?"btn-outline-primary  bd-dark ":"btn-primary"])},"Enviar",2)])],40,Q)])],64))}};export{Z as default};
