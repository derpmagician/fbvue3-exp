import{r as u,q as j,u as B,o as C,s as T,x as E,a as n,c as r,b as e,j as p,e as h,F as m,k as Y,w as q,v as U,n as y,y as V,z as b,A as D,B as z,C as F,D as G,t as i,d as H,E as f,T as L,G as N}from"./index-4c9da3b4.js";const $=e("h2",null,"Chat Global",-1),I={class:"chat__window"},J={key:0},K={key:1},O={class:"bg-success text-white rounded-2 px-2 py-1"},P={class:""},Q=["onSubmit"],R={class:"mt-3 col-sm-12"},W={class:"me-2 mt-3 col-sm-12"},Z={__name:"Chat",props:{isDark:{type:Boolean}},setup(g){let _=u([]),c=u(!1),l=null;const x=j(()=>[..._.value].reverse()),v=B(),d=u(""),k=t=>{if(!t)return"";const a=t.toDate();return f(a).format("DD/MM/YYYY HH:mm:ss")},w=()=>{c.value=!0;try{const t=V(b(D,"chats"),z("createdAt","desc"),F(12));return l=G(t,a=>{_.value=a.docs.map(o=>({id:o.id,...o.data()})),c.value=!1}),l}catch(t){console.log(t),c.value=!1}},M=async(t,a)=>{try{const o=f().toDate(),s=L.fromDate(o),A={msg:t,sender:a,createdAt:s};await N(b(D,"chats"),A)}catch(o){console.error("Error enviando mensaje: ",o)}};C(()=>{w()}),T(()=>{l&&l()});const S=()=>{M(d.value,v.userData.nombre),d.value=""};return(t,a)=>{const o=E("chat-scroll");return n(),r(m,null,[$,e("div",null,[p((n(),r("div",I,[h(c)?(n(),r("div",J,"Loading docs...")):(n(),r("div",K,[e("ul",null,[(n(!0),r(m,null,Y(x.value,s=>(n(),r("li",{key:`${s==null?void 0:s.createdAt.seconds}${s==null?void 0:s.createdAt.nanoseconds}`},[e("div",{class:y(["mt-2 me-2 py-1 chat__user",s.sender===h(v).userData.nombre?"text-end":"text-start"])},[e("span",O,i(s==null?void 0:s.sender),1),H(" "+i(k(s==null?void 0:s.createdAt))+" ",1),e("div",P,i(s==null?void 0:s.msg),1)],2)]))),128))])]))])),[[o]]),e("form",{onSubmit:q(S,["prevent"]),class:"input-group input-group-sm mb-3 row"},[e("div",R,[p(e("input",{type:"text",class:"form-control",placeholder:"Ingrese Mensaje","onUpdate:modelValue":a[0]||(a[0]=s=>d.value=s)},null,512),[[U,d.value]])]),e("div",W,[e("button",{type:"submit",class:y(["btn col me-2",g.isDark?"btn-outline-primary  bd-dark ":"btn-primary"])},"Enviar",2)])],40,Q)])],64)}}};export{Z as default};
